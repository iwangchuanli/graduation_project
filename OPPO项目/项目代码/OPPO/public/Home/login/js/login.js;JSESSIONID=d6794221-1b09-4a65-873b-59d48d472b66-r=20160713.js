var isMobileRegex=/^1\d{10}$/;var isPasswordRegex=/^[0-9a-zA-Z]{6,16}$/;var isNameRegex=/^[0-9a-zA-Z\u4e00-\u9fa5]{2,12}$/;var isEmailRegex=/^([\w-_~`!#$%^&*{}.+]{3,20})+(\.[\w-]+)*@[\w-_]+((\.){1}([\w-_]+)+)+$/;var isCaptchaRegx=/^([0-9a-zA-Z\u4e00-\u9fa5])+$/;var isVercodeRegex=/^([0-9a-zA-Z])+$/;var isMibaoRegex=/^[0-9a-zA-Z\u4e00-\u9fa5]{2,20}$/;var listIndex=0,len,cookieList;window.load_status=1;var xt1=null;function showinfo(d,b,a){var c=$("#"+d);if(a==1){c.html(b).css("color","#ff5656")}else{if(a==2){c.html(b).css("color","#878b8a")}else{c.html(b).css("color","#666666")}}}function focus_func(a,b){$(a).next(".placeholder").css("display","none");var c=a.getAttribute("id");showinfo("info_"+c,b,2);$(a).parentsUntil(".pop_dlg").find(".error_tip1").html("")}function blur_func(a,b){if($(a).val()==""){$(a).next(".placeholder").css("display","block");var c=a.getAttribute("id");showinfo("info_"+c,b,1)}}var u=(function getData(){var b=window.location.href;if(b.indexOf("?")!=-1){var a=b.split("?")[1];var d=a.split("&");var e={};for(var c=0;c<d.length;c++){e[d[c].split("=")[0]]=d[c].split("=")[1]}return e}else{return{}}})();function showDiv(a){a.css({"top":$(window).height()/2-a.height()/2+$(window.document).scrollTop()+"px","margin-left":$(window).width()/2-a.width()/2+$(window.document).scrollLeft()+"px","display":"block"});$(".mask").css({"height":$(document).height(),"width":$(document).width()}).show();$("#dlg_id").val(a.attr("id"))}function hideDiv(a){a.find("input[type='text']").val("");a.find("input[type='password']").val("");a.find(".placeholder").show();a.find(".error_tip").html("");a.find(".error_tip1").html("");a.hide();$(".mask").hide();$("#dlg_id").val("")}$(".ico_close").click(function(){var a=$(this).parent();hideDiv(a);if(document.getElementById("captcha_area").style.display=="block"){$("#auth_code").attr("src",$("#captchaUrl").val()+"?vertion="+Math.random())}if(u.isDialog){window.location.href=decodeURIComponent(u.callback)}});function showToast(a,b){$("#toast_content").html(b);showDiv(a);a.fadeOut(3000);$("#mask").fadeOut(3000)}$("#repwd").focus(function(){focus_func(this,"密码包含6-16位字母、数字")});$("#repwd").blur(function(){if($(this).val()==""){$(this).next(".placeholder").css("display","block")}});$(".username, #pwd, #vercode, #vercode1, #vercode2, #vercode3, #newpwd, .answer").focus(function(){focus_func(this,"")});$(".username, #pwd, #vercode, #vercode1, #vercode2, #vercode3, #newpwd, .answer").blur(function(){blur_func(this,"")});$("#vercode").focus(function(){$("#info_pwd").html("");$("#info_username").html("")});function get_code(){$("#auth_code").attr("src",$("#captchaUrl").val()+"?vertion="+Math.random())}function get_code1(){$("#auth_code1").attr("src",$("#captchaUrl").val()+"?vertion="+Math.random())}$(document).on("click","#auth_code",function(){get_code()});$(document).on("click","#auth_code1",function(){get_code1()});$(document).on("click","#find_link1",function(){showinfo("info_login_form"," ",1);showDiv($("#find_pwd_dlg"));$("#auth_code1").attr("src",$("#captchaUrl").val()+"?vertion="+Math.random())});$(document).on("click","#activate_link",function(){$.ajax({type:"POST",url:"register/reSendMail",cache:false,contentType:"application/json; charset=utf-8",dataType:"json",data:'{"email" :"'+$.trim($("#username").val())+'"}',beforeSend:function(){},success:function(a){if(a.resultCode!=1001){if(a.resultCode==3016){showinfo("info_login_form","验证时间间隔太短",1)}else{showinfo("info_login_form",a.resultMsg,1)}$("#auth_code").attr("src",$("#captchaUrl").val()+"?vertion="+Math.random());return}showToast($("#success_toast"),"已发送验证邮件至您的邮箱，请于24小时内前往邮箱进行操作")}})});function check_login(){var d=$.trim($("#username").val());var c=$.trim($("#pwd").val());if(d.length==0){showinfo("info_username","请输入帐号",1);return false}if(c.length==0){showinfo("info_pwd","请输入密码",1);return false}$("#password").val($.md5(c));if(document.getElementById("captcha_area").style.display=="block"){var b=$.trim($("#vercode").val());if(""==b){showinfo("info_vercode","请输入验证码",1);return false}if(!b.match(isCaptchaRegx)){showinfo("info_vercode","验证码错误",1);return false}}var a='{"username":"'+encodeURIComponent(d)+'","password":"'+$.md5(c)+'","type":"1","style":"2';if(document.getElementById("captcha_area").style.display=="block"){a+='","captcha":"'+$.trim($("#vercode").val())}if(u.callback){a+='","source":"'+u.callback+'"}'}else{a+='"}'}$.ajax({type:"POST",url:$("#loginUrl").val(),cache:false,contentType:"application/json; charset=utf-8",dataType:"json",data:a,beforeSend:function(){},success:function(g){if(g.data=="1"){document.getElementById("captcha_area").style.display="block"}if(g.resultCode!=1001){switch(g.resultCode){case 2009:showinfo("info_vercode","验证码错误",1);break;case 20009:document.getElementById("captcha_area").style.display="block";showinfo("info_vercode","请输入验证码",1);break;case 3005:case 3006:case 3007:showinfo("info_username","帐号不存在",1);break;case 3008:showinfo("info_pwd","密码错误",1);break;case 3010:showinfo("info_login_form","帐号未激活，请前往邮箱进行激活。<a  id='activate_link' style='text-decoration:underline'>重新发送激活邮件</a>",1);
break;case 3030:showinfo("info_login_form","帐号存在安全风险，<a  id='find_link1' style='text-decoration:underline'>找回密码</a>后方可正常登录",1);break;case 3013:case 3027:showinfo("info_login_form","帐号已冻结",1);break;case 3016:showinfo("info_login_form","验证时间间隔太短",1);break;case 3017:showinfo("info_login_form","今日验证身份次数达到上限",1);break;case 30001:showinfo("info_login_form","此浏览器已有OPPO帐号登录，可尝试刷新页面",1);break;default:showinfo("info_login_form",g.resultMsg,1);break}$("#auth_code").attr("src",$("#captchaUrl").val()+"?vertion="+Math.random());return}if(g.data!=null&&g.data.length>0){showDiv($("#loading_toast"));len=g.data.length;cookieList=g.data;var f=cookieList[listIndex++]+"&jsonpCallback=loginCallback&_="+new Date().getTime();var e=document.createElement("script");e.src=f;document.getElementsByTagName("head")[0].appendChild(e);if(xt1!=null){clearTimeout(xt1)}xt1=setTimeout(function(){notResponse()},5000);window.load_status=0}else{if(u.callback){window.location.href=decodeURIComponent(u.callback)}else{window.location.href=$("#profileUrl").val()}}}})}function setCookie(){if(listIndex<len){var b=cookieList[listIndex++]+"&jsonpCallback=loginCallback&_="+new Date().getTime();var a=document.createElement("script");a.src=b;document.getElementsByTagName("head")[0].appendChild(a);if(xt1!=null){clearTimeout(xt1)}xt1=setTimeout(function(){notResponse()},5000);window.load_status=0}else{if(xt1!=null){clearTimeout(xt1)}if(u.callback){window.location.href=decodeURIComponent(u.callback)}else{window.location.href=$("#profileUrl").val()}}}function notResponse(){clearTimeout(xt1);if(window.load_status==0){window.load_status=1;setCookie()}}function loginCallback(a){window.load_status=1;setCookie()}$("#yz_email_dlg1").find(".login_button").click(function(){hideDiv($("#yz_email_dlg1"));if(u.isDialog){window.location.href=decodeURIComponent(u.callback)}});$("#set_pwd_dlg .cancel_btn").click(function(){hideDiv($("#set_pwd_dlg"));$("#auth_code").attr("src",$("#captchaUrl").val()+"?vertion="+Math.random());showinfo("info_repwd","密码包含6-16位字母、数字",2)});$("#set_pwd_dlg .ico_close").click(function(){showinfo("info_repwd","密码包含6-16位字母、数字",2)});$("#find_pwd_link").click(function(){_hmt.push(["_trackEvent","account","login","findMe","findMe"]);showDiv($("#find_pwd_dlg"));$("#auth_code1").attr("src",$("#captchaUrl").val()+"?vertion="+Math.random())});function check_find_pwd(){var b=$.trim($("#username1").val());var a=$.trim($("#vercode1").val());if(b.length==0){showinfo("info_username1","请输入帐号",1);return false}else{if(a.length==0){showinfo("info_vercode1","请输入验证码",1);return false}else{if(!a.match(isCaptchaRegx)){showinfo("info_vercode1","验证码错误",1)}else{$.ajax({type:"POST",url:"safety/getSafetyStatus",cache:false,contentType:"application/json; charset=utf-8",dataType:"json",data:'{"identify" :"'+encodeURIComponent(b)+'","captcha":"'+a+'","securityType":"findMe"}',beforeSend:function(){},success:function(g){if(g.resultCode!=1001){switch(g.resultCode){case 2009:showinfo("info_vercode1","验证码错误",1);break;case 3005:showinfo("info_username1","无此帐号，请重新输入",1);break;case 3016:showinfo("info_find_pwd_dlg","验证时间间隔太短",1);break;case 3017:showinfo("info_find_pwd_dlg","今日验证身份次数达到上限",1);break;case 4010:hideDiv($("#find_pwd_dlg"));showDiv($("#timeout_dlg"));break;default:showinfo("info_find_pwd_dlg",g.resultDesc,1);break}$("#auth_code1").attr("src",$("#captchaUrl").val()+"?vertion="+Math.random());return}var c=g.data;var f=c.mobile;var e=c.email;var d=c.protections;$("#requestKey_0").val(c.requestKey);if(f!==null){$("#phoneNum").html(f);$("#phoneNum1").html(f);$("#yz_email_dlg").find(".other_way").eq(0).show();if(e==null){$("#yz_sms_dlg").find(".other_way").eq(0).hide()}else{$("#yz_sms_dlg").find(".other_way").eq(0).show();$("#email").html(e);$("#email1").html(e)}if(d==null||d.length==0){$("#yz_sms_dlg").find(".other_way").eq(1).hide();$("#yz_email_dlg").find(".other_way").eq(1).hide()}else{$("#yz_sms_dlg").find(".other_way").eq(1).show();$("#yz_email_dlg").find(".other_way").eq(1).show();$("#question0").html(c.protections[0]);$("#question1").html(c.protections[1]);$("#question2").html(c.protections[2])}hideDiv($("#find_pwd_dlg"));showDiv($("#yz_sms_dlg"))}else{$("#yz_email_dlg").find(".other_way").eq(0).hide();if(e!==null){$("#email").html(e);$("#email1").html(e);if(d==null||d.length==0){$("#yz_email_dlg").find(".other_way").eq(1).hide()}else{$("#yz_email_dlg").find(".other_way").eq(1).show();$("#question0").html(c.protections[0]);$("#question1").html(c.protections[1]);$("#question2").html(c.protections[2])}hideDiv($("#find_pwd_dlg"));showDiv($("#yz_email_dlg"))}else{if(d!=null&&d.length>0){$("#question0").html(c.protections[0]);$("#question1").html(c.protections[1]);$("#question2").html(c.protections[2]);hideDiv($("#find_pwd_dlg"));showDiv($("#yz_mibao_dlg"))}else{showinfo("info_username1","该帐号无法找回密码",1);$("#auth_code1").attr("src",$("#captchaUrl").val()+"?vertion="+Math.random())}}}},complete:function(c){},error:function(c){}})}}}}$("#yz_sms_dlg").find(".login_button").click(function(){$.ajax({type:"POST",url:"safety/verifyByChannel",cache:false,contentType:"application/json; charset=utf-8",dataType:"json",data:'{"requestKey" :"'+$("#requestKey_0").val()+'","channelId":"1","securityType":"findMe"}',beforeSend:function(){},success:function(b){var a=b.resultCode;
if(a!=1001){switch(a){case 3016:showinfo("info_yz_sms_dlg","验证时间间隔太短",1);break;case 3017:showinfo("info_yz_sms_dlg","今日发送邮件次数达到上限",1);break;case 4010:hideDiv($("#yz_sms_dlg"));showDiv($("#timeout_dlg"));break;default:showinfo("info_yz_sms_dlg",b.resultDesc,1);break}return}$("#requestKey_1").val(b.data.requestKey);hideDiv($("#yz_sms_dlg"));showDiv($("#yz_sms_dlg1"));time_sms()},complete:function(a){},error:function(a){}})});$("#yz_sms_dlg1").find(".login_button").click(function(){var a=$.trim($("#vercode2").val());if(a.length==0){showinfo("info_vercode2","请输入验证码",1);return false}if(!a.match(isVercodeRegex)){showinfo("info_vercode2","验证码错误",1);return false}$.ajax({type:"POST",url:"safety/checkByChannel",cache:false,contentType:"application/json; charset=utf-8",dataType:"json",data:'{"requestKey" :"'+$("#requestKey_1").val()+'","activationCode":"'+a+'","channelId":"1"}',beforeSend:function(){},success:function(c){var b=c.resultCode;if(b!=1001){switch(b){case 2009:showinfo("info_vercode2","验证码错误",1);break;case 3016:showinfo("info_yz_sms_dlg1","验证时间间隔太短",1);break;case 3017:showinfo("info_yz_sms_dlg1","今日发送邮件次数达到上限",1);break;case 4010:document.getElementById("btn_verify").innerHTML="<span id='time'>60</span>S";document.getElementById("btn_verify").className="btn_verify_unedit";document.getElementById("btn_verify").setAttribute("onclick","");if(xh_sms!=null){clearTimeout(xh_sms)}hideDiv($("#yz_sms_dlg1"));showDiv($("#timeout_dlg"));break;default:showinfo("info_yz_sms_dlg1",c.resultDesc,1);break}return}$("#requestKey_2").val(c.data.requestKey);document.getElementById("btn_verify").innerHTML="<span id='time'>60</span>S";document.getElementById("btn_verify").className="btn_verify_unedit";document.getElementById("btn_verify").setAttribute("onclick","");if(xh_sms!=null){clearTimeout(xh_sms)}hideDiv($("#yz_sms_dlg1"));showDiv($("#set_pwd_dlg"))},complete:function(b){},error:function(b){}})});$("#yz_email_dlg").find(".login_button").click(function(){$.ajax({type:"POST",url:"safety/verifyByChannel",cache:false,contentType:"application/json; charset=utf-8",dataType:"json",data:'{"requestKey" :"'+$("#requestKey_0").val()+'","channelId":"5","securityType":"findMe"}',beforeSend:function(){},success:function(b){var a=b.resultCode;if(a!=1001){switch(a){case 2009:showinfo("info_yz_email_dlg","验证码错误",1);break;case 3016:showinfo("info_yz_email_dlg","验证时间间隔太短",1);break;case 3017:showinfo("info_yz_email_dlg","今日发送邮件次数达到上限",1);break;case 4010:hideDiv($("#yz_email_dlg"));showDiv($("#timeout_dlg"));break;default:showinfo("info_yz_email_dlg",b.resultDesc,1);break}return}$("#requestKey_1").val(b.data.requestKey);hideDiv($("#yz_email_dlg"));showDiv($("#yz_email_dlg1"))},complete:function(a){},error:function(a){}})});$("#yz_mibao_dlg").find(".login_button").click(function(){var c=$.trim($("#answer0").val());var b=$.trim($("#answer1").val());var a=$.trim($("#answer2").val());if(c.length==0){showinfo("info_answer0","请输入密保答案",1);return false}if(!c.match(isMibaoRegex)){showinfo("info_answer0","答案格式错误",1);return false}if(b.length==0){showinfo("info_answer1","请输入密保答案",1);return false}if(!b.match(isMibaoRegex)){showinfo("info_answer1","答案格式错误",1);return false}if(a.length==0){showinfo("info_answer2","请输入密保答案",1);return false}if(!a.match(isMibaoRegex)){showinfo("info_answer2","答案格式错误",1);return false}$.ajax({type:"POST",url:"safety/checkByChannel",cache:false,contentType:"application/json; charset=utf-8",dataType:"json",data:'{"requestKey" :"'+$("#requestKey_0").val()+'","answer0":"'+c+'","answer1":"'+b+'","answer2":"'+a+'","channelId":"3","securityType":"findMe"}',beforeSend:function(){},success:function(e){var d=e.resultCode;if(d!=1001){switch(d){case 2009:showinfo("info_yz_mibao_dlg","验证码错误",1);break;case 3016:showinfo("info_yz_mibao_dlg","验证时间间隔太短",1);break;case 3017:showinfo("info_yz_mibao_dlg","今日密保验证次数达到上限",1);break;case 4010:hideDiv($("#yz_mibao_dlg"));showDiv($("#timeout_dlg"));break;default:showinfo("info_yz_mibao_dlg",e.resultDesc,1);break}return}$("#requestKey_2").val(e.data.requestKey);hideDiv($("#yz_mibao_dlg"));showDiv($("#set_pwd_dlg"))},complete:function(d){},error:function(d){}})});$("#set_pwd_dlg").find(".confirm_btn").click(function(){var c=$.trim($("#newpwd").val());var b=$.trim($("#repwd").val());if(c.length==0){showinfo("info_newpwd","请输入密码",1);return false}if(b.length==0){showinfo("info_repwd","请再次输入密码",1);return false}if(!c.match(isPasswordRegex)){showinfo("info_newpwd","密码格式错误",1);return false}if(!b.match(isPasswordRegex)){showinfo("info_repwd","密码格式错误",1);return false}if(c!=b){showinfo("info_repwd","两次密码输入不一致",1);return false}var a=$.md5(c);$.ajax({type:"POST",url:"findMe",cache:false,contentType:"application/json; charset=utf-8",dataType:"json",data:'{"requestKey" :"'+$("#requestKey_2").val()+'","password":"'+a+'"}',beforeSend:function(){},success:function(d){if(d.resultCode!=1001){if(d.resultCode==30001){showinfo("info_set_pwd_dlg","新旧密码不能相同",1)}else{if(d.resultCode==4010){hideDiv($("#set_pwd_dlg"));showDiv($("#timeout_dlg"))
}else{showinfo("info_set_pwd_dlg",d.resultMsg,1)}}return}hideDiv($("#set_pwd_dlg"));showinfo("info_repwd","密码包含6-16位字母、数字",2);showToast($("#success_toast"),"已成功重置密码");if(u.isDialog){window.location.href=decodeURIComponent(u.callback)}},complete:function(d){},error:function(d){}})});var xh_sms;function time_sms(){var a=$("#time").html();a--;$("#time").html(a);xh_sms=setTimeout(function(){time_sms()},1000);if(a<1){clearTimeout(xh_sms);$("#btn_verify").html("重新获取");document.getElementById("btn_verify").className="btn_verify";document.getElementById("btn_verify").setAttribute("onclick","send_verify_sms()")}}$("#yz_sms_dlg1 .ico_close").click(function(){document.getElementById("btn_verify").innerHTML="<span id='time'>60</span>S";document.getElementById("btn_verify").className="btn_verify_unedit";document.getElementById("btn_verify").setAttribute("onclick","");if(xh_sms!=null){clearTimeout(xh_sms)}});function send_verify_sms(){document.getElementById("btn_verify").innerHTML="<span id='time'>60</span>S";document.getElementById("btn_verify").className="btn_verify_unedit";document.getElementById("btn_verify").setAttribute("onclick","");time_sms();$.ajax({type:"POST",url:"safety/verifyByChannel",cache:false,contentType:"application/json; charset=utf-8",dataType:"json",data:'{"requestKey" :"'+$("#requestKey_0").val()+'","channelId":"1","securityType":"findMe"}',beforeSend:function(){},success:function(b){var a=b.resultCode;if(a!=1001){switch(a){case 2009:showinfo("info_yz_sms_dlg1","验证码错误",1);break;case 3016:showinfo("info_yz_sms_dlg1","验证时间间隔太短",1);break;case 3017:showinfo("info_yz_sms_dlg1","今日发送短信次数达到上限",1);break;case 4010:hideDiv($("#yz_sms_dlg1"));document.getElementById("btn_verify").innerHTML="<span id='time'>60</span>S";document.getElementById("btn_verify").className="btn_verify_unedit";document.getElementById("btn_verify").setAttribute("onclick","");if(xh_sms!=null){clearTimeout(xh_sms)}showDiv($("#timeout_dlg"));break;default:showinfo("info_yz_sms_dlg1",b.resultDesc,1);break}return}$("#requestKey_1").val(b.data.requestKey)},complete:function(a){},error:function(a){}})}$("#vercode, #username, #pwd").keypress(function(b){var a=b.which;if(a===13){b.preventDefault();check_login()}});$("#find_pwd_dlg #username1,#find_pwd_dlg #vercode1").keypress(function(b){var a=b.which;if(a===13){b.preventDefault();$("#find_pwd_dlg .login_button").click()}});$("#yz_sms_dlg1 #vercode2").keypress(function(b){var a=b.which;if(a===13){b.preventDefault();$("#yz_sms_dlg1 .login_button").click()}});$("#yz_mibao_dlg #answer0, #yz_mibao_dlg #answer1, #yz_mibao_dlg #answer2").keypress(function(b){var a=b.which;if(a===13){b.preventDefault();$("#yz_mibao_dlg .login_button").click()}});$("#set_pwd_dlg  #newpwd, #set_pwd_dlg #repwd").keypress(function(b){var a=b.which;if(a===13){b.preventDefault();$("#set_pwd_dlg .confirm_btn").click()}});$("#timeout_btn").click(function(){hideDiv($("#timeout_dlg"));$("#auth_code").attr("src",$("#captchaUrl").val()+"?vertion="+Math.random())});$(".other_link").click(function(){if(typeof $(this).data("tj")!="undefined"&&typeof _hmt!="undefined"){var a=$(this).data("tj");var b=a.split("|");_hmt.push(["_trackEvent",b[0],b[1],b[2],b[3]]);window.location.href=$(this).attr("link")}});$("#registerBtn").click(function(){window.location.href=$(this).attr("link")});$(document).ready(function(){if($("#needCaptcha").val()=="1"){document.getElementById("captcha_area").style.display="block";$("#auth_code").attr("src",$("#captchaUrl").val()+"?vertion="+Math.random())}if(u.callback){$(".ico_qq").attr("link","http://my.oppo.com/auth/qqlogin?callback="+u.callback);$(".ico_wb").attr("link","http://my.oppo.com/auth/sinalogin?callback="+u.callback);$(".ico_alipay").attr("link","http://my.oppo.com/auth/alipaylogin?callback="+u.callback);$(".ico_wx").attr("link","http://my.oppo.com/auth/wxlogin?callback="+u.callback);$("#registerBtn").attr("link",$("#registerBtn").attr("link")+"&callback="+u.callback)}setTimeout(function(){if($("#username").val()!=""){$("#username").next(".placeholder").css("display","none")}if($("#pwd").val()!=""){$("#pwd").next(".placeholder").css("display","none")}},300);if(u.isDialog){showDiv($("#find_pwd_dlg"));$("#auth_code1").attr("src",$("#captchaUrl").val()+"?vertion="+Math.random())}});window.onresize=function(){$(".mask").css({"height":$(document).height(),"width":$(document).width()});var a=$("#dlg_id").val();if(a!=""){var b=$("#"+a);b.css({"top":$(window).height()/2-b.height()/2+$(window.document).scrollTop()+"px","margin-left":$(window).width()/2-220+$(window.document).scrollLeft()+"px"})}};