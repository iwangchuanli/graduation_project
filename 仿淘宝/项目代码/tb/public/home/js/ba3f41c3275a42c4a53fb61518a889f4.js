KISSY.add("tb-mod/tb-top/0.0.4/index",function(t,n){function o(){}return o.prototype={init:function(){}},o});KISSY.add("tb-mod/tb-home-header/0.0.17/mods/search",function(e,a,t,n,o,r,l,c){function i(a){a.el&&a.events&&e.each(a.events,function(e,t){if(t&&e&&~t.indexOf(" ")){var n=t.replace(" ","^").split("^"),o=n[0],r=n[1],e=a[e]||e;s(a.el).delegate(o,r,e,a)}})}var s=l.all,u=document,h=window.T||{},d=(window.__HubCache=window.__HubCache||{},function(e){var a=this.el=e;this.$tab=a.one(".J_SearchTabBox"),this.$q=s("#q"),this.$label=a.one(".J_Placeholder"),this.forms=u.forms.search,this.$icon=a.one(".J_SearchIcon"),this.events={"mouseenter #J_SearchTab":"toggleTabHandler","mouseleave #J_SearchTab":"toggleTabHandler","click .J_SearchTab":"clickTabHandler","focusin #q":"focusInputHandler","focusout #q":"blurInputHandler","click #J_SearchIcon":"clickIconHandler"}});return d.prototype.init=function(){var e=this;e.initSearchSuggest(),i(this)},d.prototype.initSearchSuggest=function(){var a=this;e.use("kg/search-suggest/6.0.12/,kg/search-suggest/6.0.12/plugin/history,kg/search-suggest/6.0.12/plugin/cloud,kg/search-suggest/6.0.12/plugin/tab,kg/search-suggest/6.0.12/plugin/history-magic,kg/search-suggest/6.0.12/new_suggest.css",function(e,t,n,o,r,l){var i=["history","c2c_activity","mall","cat","global","list","shop","cloud"],u=[new n,new r({activeCls:"selected",node:a.el.all("#J_SearchModule li.J_SearchTab")}),new o,new l],d="//suggest.taobao.com/sug?k=1&area=c2c",g="",m=new t({plugins:u,sugConfig:{sourceUrl:d,node:"#q",focused:a.cancelInputAutofocus()?!1:!0,resultFormat:g},mods:{sort:i}});m.comboBox.on("beforeShow",function(){window.T=window.T||{},h.$sug||(h.$sug=m.get("menu").get("el"))}),c.ie&&11===c.ie&&m.comboBox.get("menu").on("afterRenderUI",function(){this.get("el").on("click",{fn:function(e){m.comboClick(e)},once:!0})}),s(".btn-search").on("click",function(t){t.halt();var n,o=a.$q,r=s("#J_TSearchForm");""===e.trim(o.val())&&(a.isTmall?(n=s(".J_TmallPlaceholder").children("label").attr("data-q"),a.hidden(!0,"from","tbmain_1_placeholder")):(n=s(".J_TbPlaceholder").all("span").text(),a.hidden(!1)),a.$label.hide(),o.val(n)),r.fire("submit")})})},d.prototype.toggleTabHandler=function(e){var a=this,t=e.type;"mouseenter"===t?a.$tab.addClass("triggers-hover"):a.$tab.removeClass("triggers-hover")},d.prototype.clickTabHandler=function(e){var a=this,t=s(e.currentTarget);a.forms.search_type.value=t.attr("data-searchType"),a.isTmall="true"===t.attr("data-tmall"),a.isTmall?s(".J_SearchPanel").addClass("tmall-search-panel"):s(".J_SearchPanel").removeClass("tmall-search-panel")},d.prototype.hidden=function(e,a,n){var o=s(".J_SearchPanel").all("form");if(e){var r='<input type="hidden" name="{{name}}" value="{{value}}" class="hidden-{{name}}">',l=new t(r).render({name:a,value:n});s(".hidden-"+a).length||o.append(l)}else{var c=s(".hidden-"+a);c.length&&c.remove()}},d.prototype.focusInputHandler=function(){var e=this;e.forms.className="search-panel-focused"},d.prototype.blurInputHandler=function(){var a=this;""===e.trim(a.$q.val())&&(a.forms.className="")},d.prototype.clickIconHandler=function(){var e=this;e.$q.fire("focus")},d.prototype.cancelInputAutofocus=function(){var e=location.hash;try{if(/^#all\-special\-market\-(\d){1}$/.test(e)){var a=s(e);return a.length>0&&a.scrollIntoView(),!0}}catch(t){}},d},{requires:["io","tms/xtemplate","anim","json","cookie","node","ua"]}),KISSY.add("tb-mod/tb-home-header/0.0.17/index",["./mods/search","node"],function(e,a){function t(){this.init.apply(this,arguments)}var n=a("./mods/search"),o=a("node");return t.prototype={init:function(a,t){var r=this;r.$module=o.one(a),t?r.loadData(t):r.bindEvent(),e.config({modules:{combobox:{alias:["kg/combobox/0.0.2/index"]}}}),new n(o.all("#J_SearchModule")).init()},loadData:function(e){},bindEvent:function(){var e=this;e.$module.one(".J_QrFt").on("click",function(a){e.$module.one(".tb-qr").hide()})}},t});